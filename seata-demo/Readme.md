# 分布式事务

**什么是事务:** 将多个数据库操作打包成一个`不可分割`的整理来进行执行

```sql
start transaction; -- 开启事务

-- 若干sql操作

commit; -- 提交事务
```

## ACID

最终要保证`一致性`, 其他特性都是为一致性服务的

![image-20230927151605166](C:\Users\陈其丰\AppData\Roaming\Typora\typora-user-images\image-20230927151605166.png)

+ Atomicity: 操作要么全成功, 要么全失败
  + 基于`undo log`来实现
+ Isolation: 事务执行过程中相互隔离, 事务之间不能相互干扰, 不能查看未提交的数据
  + 写与写隔离 - 锁实现
  + 写与读隔离 - MVCC实现
















一个事务一个数据库连接

### 2PC问题

一直持有连接,协调者通知提交或回滚, 才会释放连接, 降低并发
网络问题, 数据不一致
协调者单点问题



秒杀不要用AT


金融领域 TCC

电商 MQ
